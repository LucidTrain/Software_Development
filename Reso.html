<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crop Health & Planning</title>
  <style>
    :root {
      --primary: #2e7d32;
      --primary-light: #60ad5e;
      --primary-dark: #005005;
      --secondary: #ffd54f;
      --secondary-light: #ffff81;
      --secondary-dark: #c8a415;
      --text-on-primary: #ffffff;
      --text-on-secondary: #212121;
      --background: #f9f9f9;
      --card-bg: #ffffff;
      --border: #e0e0e0;
      --success: #4caf50;
      --warning: #ff9800;
      --error: #f44336;
      --info: #2196f3;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Arial', sans-serif;
    }
    
    body {
      background-color: var(--background);
      color: #333;
      line-height: 1.6;
    }
    
    header {
      background-color: var(--primary);
      color: var(--text-on-primary);
      padding: 1rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .logo {
      font-size: 1.5rem;
      font-weight: bold;
      display: flex;
      align-items: center;
    }
    
    .logo svg {
      margin-right: 0.5rem;
    }
    
    .nav-links {
      display: flex;
      list-style: none;
    }
    
    .nav-links li {
      margin: 0 1rem;
    }
    
    .nav-links a {
      color: var(--text-on-primary);
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s;
    }
    
    .nav-links a:hover {
      color: var(--secondary);
    }
    
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .card {
      background-color: var(--card-bg);
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    
    .card-header h2 {
      font-size: 1.2rem;
      color: var(--primary-dark);
    }
    
    .card-content {
      margin-bottom: 1rem;
    }
    
    .btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
    }
    
    .btn-primary {
      background-color: var(--primary);
      color: var(--text-on-primary);
    }
    
    .btn-primary:hover {
      background-color: var(--primary-dark);
    }
    
    .btn-secondary {
      background-color: var(--secondary);
      color: var(--text-on-secondary);
    }
    
    .btn-secondary:hover {
      background-color: var(--secondary-dark);
    }
    
    .form-group {
      margin-bottom: 1rem;
    }
    
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 1rem;
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
      margin-bottom: 1.5rem;
    }
    
    .tab {
      padding: 0.5rem 1rem;
      cursor: pointer;
      border-bottom: 2px solid transparent;
    }
    
    .tab.active {
      border-bottom: 2px solid var(--primary);
      color: var(--primary);
      font-weight: bold;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .field-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 10px;
      margin-bottom: 1rem;
    }
    
    .field-cell {
      height: 40px;
      border: 1px solid var(--border);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    
    .field-cell.selected {
      background-color: var(--primary-light);
      color: var(--text-on-primary);
    }
    
    .crop-recommendation {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .crop-card {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1rem;
      width: calc(33.333% - 1rem);
      text-align: center;
      transition: transform 0.3s;
    }
    
    .crop-card:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .crop-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }
    
    .analytics-section {
      margin-top: 2rem;
    }
    
    .chart-container {
      height: 300px;
      margin-bottom: 2rem;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1.5rem;
    }
    
    th, td {
      padding: 0.75rem;
      border: 1px solid var(--border);
      text-align: left;
    }
    
    th {
      background-color: var(--primary-light);
      color: var(--text-on-primary);
    }
    
    tr:nth-child(even) {
      background-color: #f2f2f2;
    }
    
    .alert {
      padding: 1rem;
      border-radius: 4px;
      margin-bottom: 1rem;
    }
    
    .alert-success {
      background-color: #dff0d8;
      color: #3c763d;
      border: 1px solid #d6e9c6;
    }
    
    .alert-warning {
      background-color: #fcf8e3;
      color: #8a6d3b;
      border: 1px solid #faebcc;
    }
    
    .alert-danger {
      background-color: #f2dede;
      color: #a94442;
      border: 1px solid #ebccd1;
    }
    
    footer {
      background-color: var(--primary-dark);
      color: var(--text-on-primary);
      text-align: center;
      padding: 1.5rem;
      margin-top: 3rem;
    }
    
    @media (max-width: 768px) {
      .dashboard {
        grid-template-columns: 1fr;
      }
      
      .crop-card {
        width: 100%;
      }
      
      .nav-links {
        display: none;
      }
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <div class="logo">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2v8"></path>
          <path d="M4.93 10.93l1.41 1.41"></path>
          <path d="M2 18h2"></path>
          <path d="M19.07 10.93l-1.41 1.41"></path>
          <path d="M22 18h-2"></path>
          <path d="M16 18a4 4 0 0 1-8 0"></path>
          <path d="M12 10v2"></path>
        </svg>
        Crop Health & Planning
      </div>
      <ul class="nav-links">
        <li><a href="#dashboard">Dashboard</a></li>
        <li><a href="#crop-rotation">Crop Rotation</a></li>
        <li><a href="#yield-prediction">Yield Prediction</a></li>
        <li><a href="#crop-recommender">Crop Recommender</a></li>
        <li><a href="#profit-analysis">Profit Analysis</a></li>
      </ul>
    </nav>
  </header>

  <div class="container">
    <section id="dashboard" class="dashboard">
      <div class="card">
        <div class="card-header">
          <h2>Weather Forecast</h2>
        </div>
        <div class="card-content">
          <div id="weather-info">
            <p>Loading weather data...</p>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h2>Soil Health</h2>
        </div>
        <div class="card-content">
          <div id="soil-health-gauge"></div>
          <p>Last soil test: <span id="last-soil-test">03/10/2025</span></p>
        </div>
        <button class="btn btn-primary" id="update-soil-data">Update Soil Data</button>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h2>Upcoming Tasks</h2>
        </div>
        <div class="card-content">
          <ul id="tasks-list">
            <li>Prepare fields for spring planting (Due: Mar 20)</li>
            <li>Order corn seeds (Due: Mar 25)</li>
            <li>Schedule equipment maintenance (Due: Apr 5)</li>
          </ul>
        </div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h2>Crop Health Alerts</h2>
        </div>
        <div class="card-content">
          <div class="alert alert-warning">
            <strong>Wheat Field 3:</strong> Potential pest issue detected
          </div>
          <div class="alert alert-success">
            <strong>Corn Field 1:</strong> Optimal growth conditions
          </div>
        </div>
      </div>
    </section>

    <section id="crop-rotation" class="tab-section">
      <h1>Crop Rotation Planner</h1>
      <p>Plan your crop rotations to maximize soil health and yield</p>
      
      <div class="tabs">
        <div class="tab active" data-tab="field-selection">Field Selection</div>
        <div class="tab" data-tab="rotation-history">Rotation History</div>
        <div class="tab" data-tab="rotation-plan">Rotation Plan</div>
      </div>
      
      <div id="field-selection" class="tab-content active">
        <h2>Select Fields for Planning</h2>
        <div class="field-grid" id="fields-grid">
          <!-- Field cells will be dynamically generated -->
        </div>
        
        <div class="form-group">
          <label for="acres-input">Total Acres Selected: </label>
          <input type="text" id="acres-input" value="0" readonly>
        </div>
        
        <button class="btn btn-primary" id="continue-to-rotation">Continue to Rotation Planning</button>
      </div>
      
      <div id="rotation-history" class="tab-content">
        <h2>Past Crop Rotation</h2>
        <table id="rotation-history-table">
          <thead>
            <tr>
              <th>Field</th>
              <th>2023</th>
              <th>2024</th>
              <th>2025 (Current)</th>
            </tr>
          </thead>
          <tbody>
            <!-- Rotation history data will be dynamically loaded -->
          </tbody>
        </table>
      </div>
      
      <div id="rotation-plan" class="tab-content">
        <h2>Rotation Plan Recommendations</h2>
        <div class="form-group">
          <label for="planning-year">Planning for year:</label>
          <select id="planning-year">
            <option value="2026">2026</option>
            <option value="2027">2027</option>
            <option value="2028">2028</option>
          </select>
        </div>
        
        <div id="rotation-recommendations">
          <!-- Recommendations will be dynamically generated -->
        </div>
        
        <button class="btn btn-primary" id="save-rotation-plan">Save Rotation Plan</button>
      </div>
    </section>

    <section id="yield-prediction" class="tab-section">
      <h1>Yield Prediction Model</h1>
      <p>Predict your crop yields based on historical data and current conditions</p>
      
      <div class="form-group">
        <label for="crop-type">Crop Type:</label>
        <select id="crop-type">
          <option value="corn">Corn</option>
          <option value="wheat">Wheat</option>
          <option value="soybean">Soybean</option>
          <option value="cotton">Cotton</option>
          <option value="rice">Rice</option>
        </select>
      </div>
      
      <div class="form-group">
<label for="field-selection">Field:</label>
        <select id="field-selection">
          <option value="field1">Field 1 - North (45 acres)</option>
          <option value="field2">Field 2 - South (32 acres)</option>
          <option value="field3">Field 3 - East (28 acres)</option>
          <option value="field4">Field 4 - West (50 acres)</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="planting-date">Planting Date:</label>
        <input type="date" id="planting-date" value="2025-04-15">
      </div>
      
      <div class="form-group">
        <label for="soil-quality">Soil Quality Rating (1-10):</label>
        <input type="range" id="soil-quality" min="1" max="10" value="7">
        <span id="soil-quality-value">7</span>
      </div>
      
      <div class="form-group">
        <label for="fertilizer-type">Fertilizer Type:</label>
        <select id="fertilizer-type">
          <option value="nitrogen">Nitrogen Rich</option>
          <option value="phosphorus">Phosphorus Rich</option>
          <option value="potassium">Potassium Rich</option>
          <option value="balanced">Balanced NPK</option>
          <option value="organic">Organic Compost</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="irrigation-method">Irrigation Method:</label>
        <select id="irrigation-method">
          <option value="drip">Drip Irrigation</option>
          <option value="sprinkler">Sprinkler System</option>
          <option value="flood">Flood Irrigation</option>
          <option value="rainfed">Rainfed</option>
        </select>
      </div>
      
      <button class="btn btn-primary" id="predict-yield">Predict Yield</button>
      
      <div id="yield-results" style="display: none;">
        <h2>Yield Prediction Results</h2>
        <div class="chart-container" id="yield-chart"></div>
        
        <div class="card">
          <div class="card-header">
            <h2>Predicted Yield Summary</h2>
          </div>
          <div class="card-content">
            <p>Predicted Yield: <strong><span id="predicted-yield-value">0</span> bushels/acre</strong></p>
            <p>Total Expected Yield: <strong><span id="total-yield-value">0</span> bushels</strong></p>
            <p>Confidence Range: <span id="confidence-range">±0%</span></p>
            <p>Comparison to Previous Year: <span id="yield-comparison">0%</span></p>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h2>Yield Factors Analysis</h2>
          </div>
          <div class="card-content">
            <div id="yield-factors"></div>
          </div>
        </div>
      </div>
    </section>

    <section id="crop-recommender" class="tab-section">
      <h1>Crop Recommender</h1>
      <p>Get personalized crop recommendations based on your soil, climate, and goals</p>
      
      <div class="form-group">
        <label for="soil-type">Soil Type:</label>
        <select id="soil-type">
          <option value="loam">Loam</option>
          <option value="clay">Clay</option>
          <option value="sandy">Sandy</option>
          <option value="silt">Silty</option>
          <option value="chalky">Chalky</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="soil-ph">Soil pH:</label>
        <input type="range" id="soil-ph" min="4" max="9" step="0.1" value="6.5">
        <span id="soil-ph-value">6.5</span>
      </div>
      
      <div class="form-group">
        <label for="region">Climate Region:</label>
        <select id="region">
          <option value="midwest">Midwest</option>
          <option value="southeast">Southeast</option>
          <option value="southwest">Southwest</option>
          <option value="northeast">Northeast</option>
          <option value="northwest">Northwest</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="available-water">Available Water Resources:</label>
        <select id="available-water">
          <option value="abundant">Abundant</option>
          <option value="adequate">Adequate</option>
          <option value="limited">Limited</option>
          <option value="scarce">Scarce</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Optimization Goals:</label>
        <div>
          <input type="checkbox" id="goal-profit" checked>
          <label for="goal-profit">Maximize Profit</label>
        </div>
        <div>
          <input type="checkbox" id="goal-sustainability">
          <label for="goal-sustainability">Sustainability</label>
        </div>
        <div>
          <input type="checkbox" id="goal-water">
          <label for="goal-water">Water Conservation</label>
        </div>
        <div>
          <input type="checkbox" id="goal-labor">
          <label for="goal-labor">Minimize Labor</label>
        </div>
      </div>
      
      <button class="btn btn-primary" id="recommend-crops">Get Recommendations</button>
      
      <div id="recommendation-results" style="display: none;">
        <h2>Recommended Crops</h2>
        <div class="crop-recommendation" id="recommended-crops-container">
          <!-- Crop recommendations will be generated here -->
        </div>
        
        <div class="card">
          <div class="card-header">
            <h2>Compatibility Analysis</h2>
          </div>
          <div class="card-content">
            <table id="compatibility-table">
              <thead>
                <tr>
                  <th>Factor</th>
                  <th>Rating</th>
                  <th>Notes</th>
                </tr>
              </thead>
              <tbody>
                <!-- Compatibility data will be generated here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <section id="profit-analysis" class="tab-section">
      <h1>Profit Analysis & Forecasting</h1>
      <p>Analyze potential profits and optimize your farming strategy</p>
      
      <div class="tabs">
        <div class="tab active" data-tab="profit-calculator">Profit Calculator</div>
        <div class="tab" data-tab="market-insights">Market Insights</div>
        <div class="tab" data-tab="scenario-planner">Scenario Planner</div>
      </div>
      
      <div id="profit-calculator" class="tab-content active">
        <h2>Crop Profit Calculator</h2>
        
        <div class="form-group">
          <label for="profit-crop">Crop:</label>
          <select id="profit-crop">
            <option value="corn">Corn</option>
            <option value="wheat">Wheat</option>
            <option value="soybean">Soybean</option>
            <option value="cotton">Cotton</option>
            <option value="rice">Rice</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="acreage">Acreage:</label>
          <input type="number" id="acreage" value="100">
        </div>
        
        <div class="form-group">
          <label for="expected-yield">Expected Yield (bushels/acre):</label>
          <input type="number" id="expected-yield" value="180">
        </div>
        
        <div class="form-group">
          <label for="market-price">Market Price ($/bushel):</label>
          <input type="number" id="market-price" value="5.75" step="0.01">
        </div>
        
        <h3>Input Costs</h3>
        
        <div class="form-group">
          <label for="seed-cost">Seed Cost ($/acre):</label>
          <input type="number" id="seed-cost" value="120">
        </div>
        
        <div class="form-group">
          <label for="fertilizer-cost">Fertilizer Cost ($/acre):</label>
          <input type="number" id="fertilizer-cost" value="150">
        </div>
        
        <div class="form-group">
          <label for="pesticide-cost">Pesticide Cost ($/acre):</label>
          <input type="number" id="pesticide-cost" value="60">
        </div>
        
        <div class="form-group">
          <label for="labor-cost">Labor Cost ($/acre):</label>
          <input type="number" id="labor-cost" value="85">
        </div>
        
        <div class="form-group">
          <label for="equipment-cost">Equipment Cost ($/acre):</label>
          <input type="number" id="equipment-cost" value="95">
        </div>
        
        <div class="form-group">
          <label for="irrigation-cost">Irrigation Cost ($/acre):</label>
          <input type="number" id="irrigation-cost" value="75">
        </div>
        
        <div class="form-group">
          <label for="other-costs">Other Costs ($/acre):</label>
          <input type="number" id="other-costs" value="40">
        </div>
        
        <button class="btn btn-primary" id="calculate-profit">Calculate Profit</button>
        
        <div id="profit-results" style="display: none;">
          <h2>Profit Analysis Results</h2>
          
          <div class="card">
            <div class="card-header">
              <h2>Profit Summary</h2>
            </div>
            <div class="card-content">
              <p>Total Revenue: <strong>$<span id="total-revenue">0</span></strong></p>
              <p>Total Costs: <strong>$<span id="total-costs">0</span></strong></p>
              <p>Net Profit: <strong>$<span id="net-profit">0</span></strong></p>
              <p>Profit per Acre: <strong>$<span id="profit-per-acre">0</span></strong></p>
              <p>Return on Investment: <strong><span id="roi">0</span>%</strong></p>
            </div>
          </div>
          
          <div class="chart-container" id="cost-breakdown-chart"></div>
          
          <div class="card">
            <div class="card-header">
              <h2>Profit Optimization Suggestions</h2>
            </div>
            <div class="card-content" id="profit-suggestions">
              <!-- Suggestions will be generated here -->
            </div>
          </div>
        </div>
      </div>
      
      <div id="market-insights" class="tab-content">
        <h2>Market Insights & Trends</h2>
        
        <div class="chart-container" id="price-trend-chart"></div>
        
        <div class="card">
          <div class="card-header">
            <h2>Price Forecasts</h2>
          </div>
          <div class="card-content">
            <table id="price-forecast-table">
              <thead>
                <tr>
                  <th>Crop</th>
                  <th>Current Price</th>
                  <th>30-Day Forecast</th>
                  <th>90-Day Forecast</th>
                  <th>Trend</th>
                </tr>
              </thead>
              <tbody>
                <!-- Price forecast data will be generated here -->
              </tbody>
            </table>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h2>Market News</h2>
          </div>
          <div class="card-content" id="market-news">
            <!-- Market news will be generated here -->
          </div>
        </div>
      </div>
      
      <div id="scenario-planner" class="tab-content">
        <h2>Scenario Planning</h2>
        <p>Compare different scenarios to make optimal planting decisions</p>
        
        <div class="form-group">
          <label for="scenario-count">Number of Scenarios to Compare:</label>
          <select id="scenario-count">
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
        </div>
        
        <div id="scenarios-container">
          <!-- Scenario inputs will be generated here -->
        </div>
        
        <button class="btn btn-primary" id="compare-scenarios">Compare Scenarios</button>
        
        <div id="scenario-results" style="display: none;">
          <h2>Scenario Comparison Results</h2>
          
          <div class="chart-container" id="scenario-comparison-chart"></div>
          
          <table id="scenario-comparison-table">
            <thead>
              <tr>
                <th>Metric</th>
                <!-- Scenario headers will be generated here -->
              </tr>
            </thead>
            <tbody>
              <!-- Scenario comparison data will be generated here -->
            </tbody>
          </table>
          
          <div class="card">
            <div class="card-header">
              <h2>Recommendation</h2>
            </div>
            <div class="card-content" id="scenario-recommendation">
              <!-- Scenario recommendation will be generated here -->
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <section id="analytics" class="analytics-section">
      <h1>Farm Analytics Dashboard</h1>
      <p>Track your farm's performance with advanced analytics</p>
      
      <div class="dashboard">
        <div class="card">
          <div class="card-header">
            <h2>Yield Trends</h2>
          </div>
          <div class="card-content">
            <div class="chart-container" id="yield-trends-chart"></div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h2>Profit Margins</h2>
          </div>
          <div class="card-content">
            <div class="chart-container" id="profit-margins-chart"></div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h2>Resource Efficiency</h2>
          </div>
          <div class="card-content">
            <div class="chart-container" id="resource-efficiency-chart"></div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h2>Sustainability Metrics</h2>
          </div>
          <div class="card-content">
<div class="chart-container" id="sustainability-chart"></div>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h2>Historical Data Analysis</h2>
        </div>
        <div class="card-content">
          <div class="form-group">
            <label for="analytics-year-range">Select Year Range:</label>
            <select id="analytics-year-range">
              <option value="1">Last Year</option>
              <option value="3" selected>Last 3 Years</option>
              <option value="5">Last 5 Years</option>
              <option value="10">Last 10 Years</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="analytics-metrics">Select Metrics:</label>
            <select id="analytics-metrics" multiple>
              <option value="yield" selected>Yield</option>
              <option value="profit" selected>Profit</option>
              <option value="costs">Costs</option>
              <option value="water">Water Usage</option>
              <option value="fertilizer">Fertilizer Usage</option>
            </select>
          </div>
          
          <button class="btn btn-primary" id="update-analytics">Update Analytics</button>
          
          <div class="chart-container" id="historical-analysis-chart"></div>
        </div>
      </div>
    </section>
  </div>
  
  <footer>
    <p>&copy; 2025 Crop Health & Planning Application | All Rights Reserved</p>
  </footer>

  <!-- JavaScript -->
  <script>
    // Main application object
    const CropApp = {
      // Application data
      data: {
        fields: [
          { id: 'field1', name: 'Field 1 - North', acres: 45, active: false },
          { id: 'field2', name: 'Field 2 - South', acres: 32, active: false },
          { id: 'field3', name: 'Field 3 - East', acres: 28, active: false },
          { id: 'field4', name: 'Field 4 - West', acres: 50, active: false },
          { id: 'field5', name: 'Field 5 - Northwest', acres: 38, active: false },
          { id: 'field6', name: 'Field 6 - Southeast', acres: 42, active: false }
        ],
        rotationHistory: {
          'field1': { '2023': 'Corn', '2024': 'Soybean', '2025': 'Wheat' },
          'field2': { '2023': 'Wheat', '2024': 'Corn', '2025': 'Soybean' },
          'field3': { '2023': 'Soybean', '2024': 'Wheat', '2025': 'Corn' },
          'field4': { '2023': 'Corn', '2024': 'Wheat', '2025': 'Clover' },
          'field5': { '2023': 'Alfalfa', '2024': 'Corn', '2025': 'Soybean' },
          'field6': { '2023': 'Soybean', '2024': 'Alfalfa', '2025': 'Corn' }
        },
        cropData: {
          'corn': {
            name: 'Corn',
            soilTypes: ['loam', 'clay', 'silt'],
            phRange: { min: 5.5, max: 7.5 },
            waterNeeds: 'high',
            profitPotential: 'high',
            laborRequirement: 'medium',
            sustainabilityRating: 'medium'
          },
          'wheat': {
            name: 'Wheat',
            soilTypes: ['loam', 'clay', 'sandy'],
            phRange: { min: 6.0, max: 7.5 },
            waterNeeds: 'medium',
            profitPotential: 'medium',
            laborRequirement: 'low',
            sustainabilityRating: 'high'
          },
          'soybean': {
            name: 'Soybean',
            soilTypes: ['loam', 'clay'],
            phRange: { min: 6.0, max: 7.0 },
            waterNeeds: 'medium',
            profitPotential: 'medium',
            laborRequirement: 'low',
            sustainabilityRating: 'high'
          },
          'cotton': {
            name: 'Cotton',
            soilTypes: ['loam', 'sandy'],
            phRange: { min: 5.8, max: 8.0 },
            waterNeeds: 'high',
            profitPotential: 'high',
            laborRequirement: 'high',
            sustainabilityRating: 'low'
          },
          'rice': {
            name: 'Rice',
            soilTypes: ['clay'],
            phRange: { min: 5.5, max: 6.5 },
            waterNeeds: 'very high',
            profitPotential: 'high',
            laborRequirement: 'high',
            sustainabilityRating: 'medium'
          },
          'alfalfa': {
            name: 'Alfalfa',
            soilTypes: ['loam', 'clay', 'silt'],
            phRange: { min: 6.5, max: 7.5 },
            waterNeeds: 'medium',
            profitPotential: 'medium',
            laborRequirement: 'medium',
            sustainabilityRating: 'very high'
          },
          'clover': {
            name: 'Clover',
            soilTypes: ['loam', 'clay'],
            phRange: { min: 6.0, max: 7.0 },
            waterNeeds: 'medium',
            profitPotential: 'low',
            laborRequirement: 'low',
            sustainabilityRating: 'very high'
          }
        },
        marketPrices: {
          'corn': 5.75,
          'wheat': 7.20,
          'soybean': 13.50,
          'cotton': 0.85,
          'rice': 14.30,
          'alfalfa': 180.00,
          'clover': 130.00
        },
        weatherData: {
          temperature: 52,
          humidity: 65,
          precipitation: {
            today: 0,
            forecast: [0, 0.1, 0.3, 0.1, 0]
          },
          forecast: [
            { day: 'Today', high: 55, low: 42, condition: 'Partly Cloudy' },
            { day: 'Tomorrow', high: 58, low: 45, condition: 'Sunny' },
            { day: 'Saturday', high: 62, low: 48, condition: 'Cloudy' },
            { day: 'Sunday', high: 59, low: 46, condition: 'Rain' },
            { day: 'Monday', high: 54, low: 40, condition: 'Partly Cloudy' }
          ]
        },
        yieldHistory: {
          'corn': [165, 172, 178, 175, 182],
          'wheat': [62, 65, 63, 68, 67],
          'soybean': [48, 52, 51, 55, 53],
          'cotton': [2.2, 2.3, 2.4, 2.5, 2.3],
          'rice': [7500, 7600, 7800, 7900, 8000]
        },
        profitHistory: {
          'corn': [450, 480, 520, 505, 535],
          'wheat': [320, 340, 330, 365, 355],
          'soybean': [380, 410, 400, 430, 415],
          'cotton': [550, 570, 590, 610, 585],
          'rice': [620, 640, 670, 685, 700]
        }
      },
      
      // Initialize application
      init: function() {
        this.renderFields();
        this.renderRotationHistory();
        this.renderWeatherData();
        this.setupEventListeners();
        this.setupTabNavigation();
      },
      
      // Set up event listeners
      setupEventListeners: function() {
        // Field selection
        document.getElementById('fields-grid').addEventListener('click', (e) => {
          if (e.target.classList.contains('field-cell')) {
            this.toggleFieldSelection(e.target.dataset.fieldId);
          }
        });
        
        // Crop rotation planning
        document.getElementById('continue-to-rotation').addEventListener('click', () => {
          this.switchTab('rotation-plan', 'crop-rotation');
        });
        
        document.getElementById('save-rotation-plan').addEventListener('click', () => {
          alert('Rotation plan has been saved successfully!');
        });
        
        // Yield prediction
        document.getElementById('predict-yield').addEventListener('click', () => {
          this.predictYield();
        });
        
        // Update soil quality display
        document.getElementById('soil-quality').addEventListener('input', (e) => {
          document.getElementById('soil-quality-value').textContent = e.target.value;
        });
        
        // Update soil pH display
        document.getElementById('soil-ph').addEventListener('input', (e) => {
          document.getElementById('soil-ph-value').textContent = e.target.value;
        });
        
        // Crop recommendation
        document.getElementById('recommend-crops').addEventListener('click', () => {
          this.recommendCrops();
        });
        
        // Profit calculation
        document.getElementById('calculate-profit').addEventListener('click', () => {
          this.calculateProfit();
        });
        
        // Compare scenarios
        document.getElementById('scenario-count').addEventListener('change', (e) => {
          this.generateScenarioInputs(parseInt(e.target.value));
        });
        
        document.getElementById('compare-scenarios').addEventListener('click', () => {
          this.compareScenarios();
        });
        
        // Update analytics
        document.getElementById('update-analytics').addEventListener('click', () => {
          this.updateAnalytics();
        });

        // Update soil data
        document.getElementById('update-soil-data').addEventListener('click', () => {
          alert('Soil data update scheduled. A technician will contact you to arrange sample collection.');
        });
      },
      
      // Set up tab navigation
      setupTabNavigation: function() {
        const tabs = document.querySelectorAll('.tab');
        tabs.forEach(tab => {
          tab.addEventListener('click', () => {
            const tabId = tab.dataset.tab;
            const tabsContainer = tab.parentElement;
            
            // Update active tab
            tabsContainer.querySelectorAll('.tab').forEach(t => {
              t.classList.remove('active');
            });
            tab.classList.add('active');
            
            // Update active content
            const tabContents = tabsContainer.nextElementSibling.parentElement.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
              content.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
          });
        });
      },
      
      // Switch to a specific tab
      switchTab: function(tabId, sectionId) {
        const section = document.getElementById(sectionId);
        const tabElement = section.querySelector(`.tab[data-tab="${tabId}"]`);
        tabElement.click();
      },
      
      // Render field selection grid
      renderFields: function() {
        const fieldsGrid = document.getElementById('fields-grid');
        let html = '';
        
        this.data.fields.forEach(field => {
          html += `<div class="field-cell ${field.active ? 'selected' : ''}" 
                     data-field-id="${field.id}">${field.name} (${field.acres} acres)</div>`;
        });
        
        fieldsGrid.innerHTML = html;
        this.updateSelectedAcres();
      },
      
      // Toggle field selection
      toggleFieldSelection: function(fieldId) {
        const field = this.data.fields.find(f => f.id === fieldId);
        if (field) {
          field.active = !field.active;
          this.renderFields();
        }
      },
      
      // Update selected acres count
      updateSelectedAcres: function() {
        const selectedAcres = this.data.fields
          .filter(field => field.active)
          .reduce((sum, field) => sum + field.acres, 0);
          
        document.getElementById('acres-input').value = selectedAcres;
      },
      
      // Render rotation history table
      renderRotationHistory: function() {
        const historyTable = document.getElementById('rotation-history-table').querySelector('tbody');
        let html = '';
        
        Object.keys(this.data.rotationHistory).forEach(fieldId => {
          const field = this.data.fields.find(f => f.id === fieldId);
          const history = this.data.rotationHistory[fieldId];
          
          html += `<tr>
                    <td>${field.name}</td>
                    <td>${history['2023']}</td>
                    <td>${history['2024']}</td>
                    <td>${history['2025']}</td>
                  </tr>`;
        });
        
        historyTable.innerHTML = html;
      },
      
      // Render weather data
      renderWeatherData: function() {
        const weatherInfo = document.getElementById('weather-info');
        const today = this.data.weatherData.forecast[0];
        
        let html = `<div>
                      <p><strong>${today.condition}</strong></p>
                      <p>Current: ${this.data.weatherData.temperature}°F</p>
                      <p>High: ${today.high}°F / Low: ${today.low}°F</p>
                      <p>Humidity: ${this.data.weatherData.humidity}%</p>
                    </div>
                    <div>
                      <h3>5-Day Forecast</h3>
                      <ul>`;
                      
        this.data.weatherData.forecast.forEach(day => {
          html += `<li>${day.day}: ${day.condition}, ${day.high}°F / ${day.low}°F</li>`;
        });
        
        html += `</ul></div>`;
        weatherInfo.innerHTML = html;
      },
      
      // Predict crop yield
      predictYield: function() {
        const cropType = document.getElementById('crop-type').value;
        const fieldId = document.getElementById('field-selection').value;
        const soilQuality = parseInt(document.getElementById('soil-quality').value);
        const field = this.data.fields.find(f => f.id === fieldId);
        
        // Calculate base yield from historical data
        const baseYield = this.data.yieldHistory[cropType][4]; // Most recent year
        
        // Apply multipliers based on inputs
        const soilMultiplier = 0.8 + (soilQuality * 0.04); // 0.8 to 1.2 based on soil quality
        const weatherMultiplier = this.calculateWeatherMultiplier(cropType);
        const fertilizer = document.getElementById('fertilizer-type').value;
        const fertilizerMultiplier = this.getFertilizerMultiplier(cropType, fertilizer);
        
        // Calculate predicted yield
        const predictedYield = Math.round(baseYield * soilMultiplier * weatherMultiplier * fertilizerMultiplier);
const totalYield = Math.round(predictedYield * field.acres);
        const confidenceRange = 5 + Math.floor(Math.random() * 6); // 5-10% range
        const comparisonToLastYear = Math.round(((predictedYield / baseYield) - 1) * 100);
        
        // Update UI
        document.getElementById('predicted-yield-value').textContent = predictedYield;
        document.getElementById('total-yield-value').textContent = totalYield;
        document.getElementById('confidence-range').textContent = `±${confidenceRange}%`;
        document.getElementById('yield-comparison').textContent = `${comparisonToLastYear >= 0 ? '+' : ''}${comparisonToLastYear}%`;
        
        // Generate yield factors analysis
        const yieldFactors = document.getElementById('yield-factors');
        yieldFactors.innerHTML = `
          <p><strong>Key Yield Factors:</strong></p>
          <ul>
            <li>Soil Quality: ${this.getImpactRating(soilMultiplier)}</li>
            <li>Weather Conditions: ${this.getImpactRating(weatherMultiplier)}</li>
            <li>Fertilizer Impact: ${this.getImpactRating(fertilizerMultiplier)}</li>
          </ul>
          <p><strong>Recommendations:</strong></p>
          <ul>
            <li>${this.getYieldRecommendation(cropType, soilQuality)}</li>
          </ul>
        `;
        
        // Show results
        document.getElementById('yield-results').style.display = 'block';
        
        // Simulate a chart (in a real app, would use Chart.js or similar)
        this.simulateYieldChart();
      },
      
      // Calculate weather multiplier for yield prediction
      calculateWeatherMultiplier: function(cropType) {
        // In a real app, this would use actual weather data and crop-specific models
        const weatherConditions = this.data.weatherData.forecast.map(day => day.condition);
        const rainCount = weatherConditions.filter(c => c.includes('Rain')).length;
        
        if (cropType === 'rice' && rainCount >= 2) return 1.15;
        if (cropType === 'cotton' && rainCount >= 3) return 0.9;
        if (cropType === 'corn' && rainCount >= 2) return 1.1;
        
        return 1.0 + (Math.random() * 0.2 - 0.1); // Random variation between 0.9 and 1.1
      },
      
      // Get fertilizer multiplier for yield prediction
      getFertilizerMultiplier: function(cropType, fertilizer) {
        const fertilizers = {
          'corn': { 'nitrogen': 1.15, 'phosphorus': 1.05, 'potassium': 1.0, 'balanced': 1.1, 'organic': 1.05 },
          'wheat': { 'nitrogen': 1.1, 'phosphorus': 1.05, 'potassium': 1.0, 'balanced': 1.08, 'organic': 1.03 },
          'soybean': { 'nitrogen': 1.0, 'phosphorus': 1.12, 'potassium': 1.08, 'balanced': 1.05, 'organic': 1.04 },
          'cotton': { 'nitrogen': 1.08, 'phosphorus': 1.05, 'potassium': 1.12, 'balanced': 1.1, 'organic': 1.02 },
          'rice': { 'nitrogen': 1.15, 'phosphorus': 1.05, 'potassium': 1.0, 'balanced': 1.1, 'organic': 1.03 }
        };
        
        return fertilizers[cropType]?.[fertilizer] || 1.0;
      },
      
      // Get impact rating text based on multiplier
      getImpactRating: function(multiplier) {
        if (multiplier >= 1.15) return "Very Positive Impact";
        if (multiplier >= 1.05) return "Positive Impact";
        if (multiplier >= 0.95) return "Neutral Impact";
        if (multiplier >= 0.85) return "Negative Impact";
        return "Very Negative Impact";
      },
      
      // Get yield recommendation based on crop and soil
      getYieldRecommendation: function(cropType, soilQuality) {
        if (soilQuality < 5) {
          return "Consider soil amendments to improve quality for better yields.";
        }
        
        const recommendations = {
          'corn': "Apply additional nitrogen prior to tasseling stage for maximum yield.",
          'wheat': "Manage irrigation carefully during heading stage for optimal grain fill.",
          'soybean': "Ensure proper inoculation with rhizobia for nitrogen fixing.",
          'cotton': "Consider foliar potassium application during boll development.",
          'rice': "Maintain proper flooding schedule for optimal growth."
        };
        
        return recommendations[cropType] || "Monitor crop regularly for pests and nutrient deficiencies.";
      },
      
      // Simulate yield chart (placeholder for chart visualization)
      simulateYieldChart: function() {
        const chartContainer = document.getElementById('yield-chart');
        chartContainer.innerHTML = '<div style="text-align: center; padding: 20px; background-color: #f5f5f5;">Interactive yield prediction chart would be displayed here.</div>';
      },
      
      // Recommend crops based on input parameters
      recommendCrops: function() {
        const soilType = document.getElementById('soil-type').value;
        const soilPh = parseFloat(document.getElementById('soil-ph').value);
        const waterAvailability = document.getElementById('available-water').value;
        const profitFocus = document.getElementById('goal-profit').checked;
        const sustainabilityFocus = document.getElementById('goal-sustainability').checked;
        
        // Filter crops based on soil type and pH
        const suitableCrops = Object.keys(this.data.cropData).filter(cropId => {
          const crop = this.data.cropData[cropId];
          return crop.soilTypes.includes(soilType) && 
                 soilPh >= crop.phRange.min &&
                 soilPh <= crop.phRange.max;
        });
        
        // Score crops based on goals
        const scoredCrops = suitableCrops.map(cropId => {
          const crop = this.data.cropData[cropId];
          let score = 0;
          
          // Water availability
          if (waterAvailability === 'abundant' && crop.waterNeeds === 'high') score += 2;
          if (waterAvailability === 'adequate' && crop.waterNeeds === 'medium') score += 2;
          if (waterAvailability === 'limited' && crop.waterNeeds === 'low') score += 3;
          if (waterAvailability === 'scarce' && crop.waterNeeds === 'very high') score -= 3;
          
          // Goals
          if (profitFocus && crop.profitPotential === 'high') score += 3;
          if (sustainabilityFocus && crop.sustainabilityRating === 'very high') score += 3;
          if (sustainabilityFocus && crop.sustainabilityRating === 'high') score += 2;
          
          return { 
            id: cropId,
            name: crop.name,
            score: score,
            compatibility: this.calculateCompatibility(crop, soilType, soilPh, waterAvailability)
          };
        });
        
        // Sort by score
        scoredCrops.sort((a, b) => b.score - a.score);
        
        // Display top recommendations (max 3)
        const recommendedCrops = scoredCrops.slice(0, 3);
        const cropContainer = document.getElementById('recommended-crops-container');
        let html = '';
        
        recommendedCrops.forEach(crop => {
          html += `
            <div class="crop-card">
              <div class="crop-icon">🌱</div>
              <h3>${crop.name}</h3>
              <p>Compatibility: ${crop.compatibility}%</p>
              <p>Current Market Price: $${this.data.marketPrices[crop.id].toFixed(2)}</p>
            </div>
          `;
        });
        
        cropContainer.innerHTML = html;
        
        // Display compatibility analysis
        const compatibilityTable = document.getElementById('compatibility-table').querySelector('tbody');
        html = '';
        
        const factors = [
          { name: 'Soil Type', rating: this.rateCompatibility(recommendedCrops[0].compatibility, 'soil') },
          { name: 'Soil pH', rating: this.rateCompatibility(recommendedCrops[0].compatibility, 'ph') },
          { name: 'Water Requirements', rating: this.rateCompatibility(recommendedCrops[0].compatibility, 'water') },
          { name: 'Climate Suitability', rating: this.rateCompatibility(recommendedCrops[0].compatibility, 'climate') }
        ];
        
        factors.forEach(factor => {
          html += `
            <tr>
              <td>${factor.name}</td>
              <td>${factor.rating.rating}</td>
              <td>${factor.rating.notes}</td>
            </tr>
          `;
        });
        
        compatibilityTable.innerHTML = html;
        
        // Show results
        document.getElementById('recommendation-results').style.display = 'block';
      },
      
      // Calculate crop compatibility percentage
      calculateCompatibility: function(crop, soilType, soilPh, waterAvailability) {
        let compatibility = 100;
        
        // Soil type check
        if (!crop.soilTypes.includes(soilType)) {
          compatibility -= 30;
        }
        
        // pH check
        const phMid = (crop.phRange.min + crop.phRange.max) / 2;
        const phDistance = Math.abs(soilPh - phMid);
        const phRange = (crop.phRange.max - crop.phRange.min) / 2;
        if (phDistance > phRange) {
          compatibility -= 25;
        } else {
          compatibility -= (phDistance / phRange) * 25;
        }
        
        // Water availability check
        const waterNeeds = {
          'very high': 4,
          'high': 3,
          'medium': 2,
          'low': 1
        };
        
        const waterAvail = {
          'abundant': 4,
          'adequate': 3,
          'limited': 2,
          'scarce': 1
        };
        
        const waterDiff = Math.abs(waterNeeds[crop.waterNeeds] - waterAvail[waterAvailability]);
        compatibility -= waterDiff * 10;
        
        return Math.max(Math.round(compatibility), 0);
      },
      
      // Rate compatibility factor
      rateCompatibility: function(overallCompatibility, factor) {
        const ratings = {
          'Excellent': 'Optimal conditions for crop growth',
          'Good': 'Favorable conditions with minor limitations',
          'Fair': 'Some limitations that may affect yield',
          'Poor': 'Significant limitations, consider alternatives'
        };
        
        let rating;
        if (overallCompatibility >= 85) rating = 'Excellent';
        else if (overallCompatibility >= 70) rating = 'Good';
        else if (overallCompatibility >= 50) rating = 'Fair';
        else rating = 'Poor';
        
        const factorNotes = {
          'soil': {
            'Excellent': 'Ideal soil type for this crop',
            'Good': 'Compatible soil type with minor amendments needed',
            'Fair': 'May require significant soil amendments',
            'Poor': 'Suboptimal soil type for this crop'
          },
          'ph': {
            'Excellent': 'pH is in optimal range',
            'Good': 'pH is acceptable but not ideal',
            'Fair': 'pH adjustment recommended',
            'Poor': 'pH is outside acceptable range'
          },
          'water': {
            'Excellent': 'Water availability matches crop needs',
            'Good': 'Water availability is adequate',
            'Fair': 'Irrigation management will be critical',
            'Poor': 'Water availability is mismatched with crop needs'
          },
          'climate': {
            'Excellent': 'Climate is ideal for this crop',
            'Good': 'Climate is suitable with minor risks',
            'Fair': 'Some climate-related challenges expected',
            'Poor': 'Climate poses significant risks'
          }
        };
        
        return {
          rating: rating,
          notes: factorNotes[factor][rating]
        };
      },
      
      // Calculate profit based on inputs
      calculateProfit: function() {
        const crop = document.getElementById('profit-crop').value;
        const acreage = parseFloat(document.getElementById('acreage').value);
        const expectedYield = parseFloat(document.getElementById('expected-yield').value);
        const marketPrice = parseFloat(document.getElementById('market-price').value);
        
        // Calculate costs
        const seedCost = parseFloat(document.getElementById('seed-cost').value);
        const fertilizerCost = parseFloat(document.getElementById('fertilizer-cost').value);
        const pesticideCost = parseFloat(document.getElementById('pesticide-cost').value);
        const laborCost = parseFloat(document.getElementById('labor-cost').value);
        const equipmentCost = parseFloat(document.getElementById('equipment-cost').value);
        const irrigationCost = parseFloat(document.getElementById('irrigation-cost').value);
        const otherCosts = parseFloat(document.getElementById('other-costs').value);
        
        const totalCostPerAcre = seedCost + fertilizerCost + pesticideCost + 
                                laborCost + equipmentCost + irrigationCost + otherCosts;
        const totalCosts = totalCostPerAcre * acreage;
        
        // Calculate revenue and profit
        const totalRevenue = expectedYield * marketPrice * acreage;
        const netProfit = totalRevenue - totalCosts;
        const profitPerAcre = netProfit / acreage;
        const roi = (netProfit / totalCosts) * 100;
        
        // Update UI
        document.getElementById('total-revenue').textContent = totalRevenue.toFixed(2);
        document.getElementById('total-costs').textContent = totalCosts.toFixed(2);
        document.getElementById('net-profit').textContent = netProfit.toFixed(2);
        document.getElementById('profit-per-acre').textContent = profitPerAcre.toFixed(2);
        document.getElementById('roi').textContent = roi.toFixed(2);
        
        // Generate profit optimization suggestions
        const suggestions = document.getElementById('profit-suggestions');
        let html = '<ul>';
        
        // Generate dynamic suggestions based on inputs
        if (profitPerAcre < 200) {
          html += '<li>Consider higher-value crops or premium varieties to increase revenue.</li>';
        }
        
        if (totalCostPerAcre > 600) {
          html += '<li>Look for opportunities to reduce input costs without compromising yield.</li>';
        }
        
        if (seedCost > 130) {
          html += '<li>Evaluate bulk seed purchasing or early ordering discounts.</li>';
        }
        
        if (fertilizerCost > 160) {
          html += '<li>Consider soil testing to optimize fertilizer application rates.</li>';
        }
        
        if (irrigationCost > 90) {
          html += '<li>Evaluate more efficient irrigation technologies to reduce water usage.</li>';
        }
        
        // Additional suggestions
        if (laborCost > 120) {
          html += '<li>Consider mechanization options to reduce labor costs.</li>';
        }
        
        html += '</ul>';
        suggestions.innerHTML = html;
        
        // Show results
        document.getElementById('profit-results').style.display = 'block';
        
        // Simulate profit chart (placeholder for chart visualization)
        this.simulateProfitChart();
      },
      
      // Simulate profit chart (placeholder for chart visualization)
      simulateProfitChart: function() {
        const chartContainer = document.getElementById('profit-chart');
        chartContainer.innerHTML = '<div style="text-align: center; padding: 20px; background-color: #f5f5f5;">Interactive profit breakdown chart would be displayed here.</div>';
      },
      
      // Generate scenario inputs based on count
      generateScenarioInputs: function(count) {
        const scenariosContainer = document.getElementById('scenarios-container');
        let html = '';
        
        for (let i = 1; i <= count; i++) {
          html += `
            <div class="scenario-card">
              <h3>Scenario ${i}</h3>
              <div class="form-group">
                <label>Crop:</label>
                <select id="scenario-crop-${i}" class="form-control">
                  <option value="corn">Corn</option>
                  <option value="wheat">Wheat</option>
                  <option value="soybean">Soybean</option>
                  <option value="cotton">Cotton</option>
                  <option value="rice">Rice</option>
                </select>
              </div>
              <div class="form-group">
                <label>Acreage:</label>
                <input type="number" id="scenario-acreage-${i}" class="form-control" value="50">
              </div>
              <div class="form-group">
                <label>Expected Yield Per Acre:</label>
                <input type="number" id="scenario-yield-${i}" class="form-control" value="175">
              </div>
              <div class="form-group">
                <label>Market Price:</label>
                <input type="number" id="scenario-price-${i}" step="0.01" class="form-control" value="5.75">
              </div>
              <div class="form-group">
                <label>Cost Per Acre:</label>
                <input type="number" id="scenario-cost-${i}" class="form-control" value="450">
              </div>
            </div>
          `;
        }
        
        scenariosContainer.innerHTML = html;
      },
      
      // Compare scenarios
      compareScenarios: function() {
        const scenarioCount = parseInt(document.getElementById('scenario-count').value);
        const scenarios = [];
        
        // Collect scenario data
        for (let i = 1; i <= scenarioCount; i++) {
          const crop = document.getElementById(`scenario-crop-${i}`).value;
          const acreage = parseFloat(document.getElementById(`scenario-acreage-${i}`).value);
          const yield = parseFloat(document.getElementById(`scenario-yield-${i}`).value);
          const price = parseFloat(document.getElementById(`scenario-price-${i}`).value);
          const costPerAcre = parseFloat(document.getElementById(`scenario-cost-${i}`).value);
          
          const totalRevenue = yield * price * acreage;
          const totalCost = costPerAcre * acreage;
          const netProfit = totalRevenue - totalCost;
          const roi = (netProfit / totalCost) * 100;
          
          scenarios.push({
            name: `Scenario ${i} (${this.data.cropData[crop].name})`,
            crop: crop,
            acreage: acreage,
            yield: yield,
            totalRevenue: totalRevenue,
            totalCost: totalCost,
            netProfit: netProfit,
            roi: roi
          });
        }
        
        // Sort scenarios by profit
        scenarios.sort((a, b) => b.netProfit - a.netProfit);
        
        // Display comparison table
        const comparisonTable = document.getElementById('comparison-table').querySelector('tbody');
        let html = '';
        
        scenarios.forEach(scenario => {
          html += `
            <tr>
              <td>${scenario.name}</td>
              <td>${scenario.acreage}</td>
              <td>$${scenario.totalRevenue.toFixed(2)}</td>
              <td>$${scenario.totalCost.toFixed(2)}</td>
              <td>$${scenario.netProfit.toFixed(2)}</td>
              <td>${scenario.roi.toFixed(2)}%</td>
            </tr>
          `;
        });
        
        comparisonTable.innerHTML = html;
        
        // Generate summary
        const comparisonSummary = document.getElementById('comparison-summary');
        const bestScenario = scenarios[0];
        
        comparisonSummary.innerHTML = `
          <p><strong>Recommended Approach:</strong> ${bestScenario.name}</p>
          <p><strong>Projected Profit:</strong> $${bestScenario.netProfit.toFixed(2)}</p>
          <p><strong>Return on Investment:</strong> ${bestScenario.roi.toFixed(2)}%</p>
          <p><strong>Key Factors:</strong> ${this.getScenarioRecommendationReason(bestScenario)}</p>
        `;
        
        // Show results
        document.getElementById('comparison-results').style.display = 'block';
        
        // Simulate comparison chart
        this.simulateComparisonChart(scenarios);
      },
      
      // Get scenario recommendation reason
      getScenarioRecommendationReason: function(scenario) {
        // In a real app, this would perform more sophisticated analysis
        if (scenario.roi > 30) {
          return "High ROI with manageable risk profile.";
        } else if (scenario.netProfit > 20000) {
          return "Strong overall profit potential despite moderate ROI.";
        } else {
          return "Best balance of risk and return among available options.";
        }
      },
      
      // Simulate comparison chart (placeholder for chart visualization)
      simulateComparisonChart: function(scenarios) {
        const chartContainer = document.getElementById('comparison-chart');
        chartContainer.innerHTML = '<div style="text-align: center; padding: 20px; background-color: #f5f5f5;">Interactive scenario comparison chart would be displayed here.</div>';
      },
      
      // Update analytics data
      updateAnalytics: function() {
        // Simulate analytics data loading and display
        const analyticsContainer = document.getElementById('analytics-container');
        analyticsContainer.innerHTML = '<div class="loading">Loading analytics data...</div>';
        
        // Simulate API call delay
        setTimeout(() => {
          this.renderAnalytics();
        }, 1000);
      },
      
      // Render analytics data
      renderAnalytics: function() {
        const analyticsContainer = document.getElementById('analytics-container');
        
        // Create sample data for visualization
        const yieldData = this.data.yieldHistory;
        const profitData = this.data.profitHistory;
        
        // Generate HTML for analytics section
        let html = `
          <div class="analytics-grid">
            <div class="analytics-card">
              <h3>Crop Yield Trends</h3>
              <div class="chart-placeholder">
                <div style="text-align: center; padding: 20px; background-color: #f5f5f5;">
                  Yield trend chart over 5 years
                </div>
              </div>
              <div class="analytics-summary">
                <p><strong>Average Yield Growth:</strong> 4.2% per year</p>
                <p><strong>Top Performing Crop:</strong> Corn (10.3% growth)</p>
              </div>
            </div>
            
            <div class="analytics-card">
              <h3>Profit Margin Analysis</h3>
              <div class="chart-placeholder">
                <div style="text-align: center; padding: 20px; background-color: #f5f5f5;">
                  Profit margin analysis chart
                </div>
              </div>
              <div class="analytics-summary">
                <p><strong>Average Profit Margin:</strong> 23.5%</p>
                <p><strong>Best Performing Crop:</strong> Rice (27.8% margin)</p>
              </div>
            </div>
            
            <div class="analytics-card">
              <h3>Input Cost Breakdown</h3>
              <div class="chart-placeholder">
                <div style="text-align: center; padding: 20px; background-color: #f5f5f5;">
                  Input cost breakdown chart
                </div>
              </div>
              <div class="analytics-summary">
                <p><strong>Largest Expense:</strong> Fertilizer (32%)</p>
                <p><strong>Fastest Growing Cost:</strong> Labor (8.5% increase)</p>
              </div>
            </div>
            
            <div class="analytics-card">
              <h3>Sustainability Metrics</h3>
              <div class="chart-placeholder">
                <div style="text-align: center; padding: 20px; background-color: #f5f5f5;">
                  Sustainability metrics chart
                </div>
              </div>
              <div class="analytics-summary">
                <p><strong>Water Usage Efficiency:</strong> 12% improvement</p>
                <p><strong>Carbon Footprint:</strong> 5% reduction YoY</p>
              </div>
            </div>
          </div>
        `;
        
        analyticsContainer.innerHTML = html;
        
        // Add insights section
        const insightsContainer = document.getElementById('insights-container');
        insightsContainer.innerHTML = `
          <h3>Key Insights</h3>
          <ul>
            <li><strong>Crop Rotation Impact:</strong> Fields using three-crop rotation showed 18% higher yield than fields with two-crop rotation.</li>
            <li><strong>Weather Correlation:</strong> Early season rainfall showed strong positive correlation with final yield (R² = 0.78).</li>
            <li><strong>Cost Reduction Opportunity:</strong> Precision fertilizer application could reduce input costs by approximately 12%.</li>
            <li><strong>Market Trend:</strong> Organic crop prices have increased 15% more than conventional crops over the past 3 years.</li>
          </ul>
        `;
      },
      
      // Handle soil data updates
      handleSoilDataUpdate: function() {
        // In a real app, this would integrate with soil testing services or labs
        const fieldId = document.getElementById('soil-field-selection').value;
        const sampleDate = document.getElementById('soil-sample-date').value;
        
        // Simulate API call or data processing
        console.log(`Scheduling soil test for field ${fieldId} on ${sampleDate}`);
        
        // Show confirmation
        alert(`Soil testing has been scheduled for ${this.data.fields.find(f => f.id === fieldId).name} on ${sampleDate}. A technician will contact you to arrange sample collection.`);
      },
      
      // Export data to various formats (placeholder function)
      exportData: function(format) {
        alert(`Exporting data in ${format} format. This feature would download crop planning data in your preferred format.`);
      },
      
      // Show help documentation
      showHelp: function(section) {
        // In a real app, this would display context-sensitive help
        alert(`Showing help documentation for: ${section}`);
      }
    };
    
    // Initialize the application when the DOM is fully loaded
    document.addEventListener('DOMContentLoaded', function() {
      CropApp.init();
    });
  </script>
  </body>
</html>
